<Page
    x:Class="MvvmSampleUwp.Views.ObservableValidatorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:MvvmSampleUwp.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:interactions="using:Microsoft.Xaml.Interactions.Core"
    xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    NavigationCacheMode="Enabled"
    mc:Ignorable="d">

    <ScrollViewer Padding="{StaticResource DocumentationPageContentPadding}" CanContentRenderOutsideBounds="True">
        <StackPanel Spacing="16">
            <controls:ValidationTextBox
                DataContext="{x:Bind ViewModel.Form}"
                HeaderText="Enter your first:"
                PlaceholderText="First name"
                PropertyName="FirstName"
                Text="{x:Bind ViewModel.Form.FirstName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <controls:ValidationTextBox
                DataContext="{x:Bind ViewModel.Form}"
                HeaderText="Enter your last name:"
                PlaceholderText="Last name"
                PropertyName="LastName"
                Text="{x:Bind ViewModel.Form.LastName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <controls:ValidationTextBox
                DataContext="{x:Bind ViewModel.Form}"
                HeaderText="Enter your email address:"
                PlaceholderText="Email"
                PropertyName="Email"
                Text="{x:Bind ViewModel.Form.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <controls:ValidationTextBox
                DataContext="{x:Bind ViewModel.Form}"
                HeaderText="Enter your phone number:"
                PlaceholderText="Phone number"
                PropertyName="PhoneNumber"
                Text="{x:Bind ViewModel.Form.PhoneNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

            <Button Command="{x:Bind ViewModel.Form.SubmitCommand}" Content="Submit" />

            <!--  Popups  -->
            <Grid>
                <muxc:InfoBar
                    x:Name="SuccessInfoBar"
                    Title="Success"
                    Message="The form was filled in correctly."
                    Severity="Success">
                    <interactivity:Interaction.Behaviors>
                        <interactions:EventTriggerBehavior EventName="FormSubmissionCompleted" SourceObject="{x:Bind ViewModel.Form}">
                            <interactions:ChangePropertyAction
                                PropertyName="IsOpen"
                                TargetObject="{x:Bind SuccessInfoBar}"
                                Value="True" />
                            <interactions:ChangePropertyAction
                                PropertyName="IsOpen"
                                TargetObject="{x:Bind FailureInfoBar}"
                                Value="False" />
                        </interactions:EventTriggerBehavior>
                    </interactivity:Interaction.Behaviors>
                </muxc:InfoBar>
                <muxc:InfoBar
                    x:Name="FailureInfoBar"
                    Title="Error"
                    Message="The form was filled in with some errors."
                    Severity="Error">
                    <muxc:InfoBar.ActionButton>
                        <Button Command="{x:Bind ViewModel.Form.ShowErrorsCommand}" Content="Show errors" />
                    </muxc:InfoBar.ActionButton>
                    <interactivity:Interaction.Behaviors>
                        <interactions:EventTriggerBehavior EventName="FormSubmissionFailed" SourceObject="{x:Bind ViewModel.Form}">
                            <interactions:ChangePropertyAction
                                PropertyName="IsOpen"
                                TargetObject="{x:Bind SuccessInfoBar}"
                                Value="False" />
                            <interactions:ChangePropertyAction
                                PropertyName="IsOpen"
                                TargetObject="{x:Bind FailureInfoBar}"
                                Value="True" />
                        </interactions:EventTriggerBehavior>
                    </interactivity:Interaction.Behaviors>
                </muxc:InfoBar>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</Page>
